@inherits BaseLayout

<div class="kui-wrapper @Context.UserSetting.Size">
    <LayoutValue Value="this" IsFixed>
        @if (IsLoaded)
        {
            if (Context.IsMobileApp)
            {
                <AppLayout>@Body</AppLayout>
            }
            else
            {
                if (Setting.LayoutMode == LayoutMode.Horizontal)
                {
                    <Layout Class="kui-layout">
                        <Header Class="kui-header">
                            <div class="left @MenuClass">
                                <div class="kui-logo"></div>
                                <AntMenu Context="Context" Mode="MenuMode.Horizontal" Accordion="Setting.Accordion" Theme="Setting.ToMenuTheme()" Items="UserMenus" />
                            </div>
                            <TopNavbar OnMenuClick="OnMenuClick" />
                        </Header>
                        <Content>
                            @if (Setting.MultiTab)
                            {
                                <ReuseTabs Class="kui-nav-tabs" TabPaneClass="kui-body" />
                            }
                            else
                            {
                                <div class="kui-body">@Body</div>
                            }
                        </Content>
                        @if (Setting.ShowFooter)
                        {
                            if (UIConfig.Footer != null)
                            {
                                <Footer Class="kui-footer">@UIConfig.Footer</Footer>
                            }
                            else
                            {
                                <Footer Class="kui-footer"><KFooter /></Footer>
                            }
                        }
                    </Layout>
                }
                else
                {
                    <Layout Class="kui-layout">
                        @if (Setting.LayoutMode == LayoutMode.Float)
                        {
                            <Sider Theme="Setting.ToSiderTheme()" Class="@MenuClass" CollapsedWidth="60" Collapsed NoTrigger>
                                <div class="kui-logo"></div>
                                <div class="kui-scroll">
                                    <AntMenu Context="Context" Mode="MenuMode.Inline" Accordion="Setting.Accordion" Theme="Setting.ToMenuTheme()" Items="UserMenus" />
                                </div>
                            </Sider>
                        }
                        else
                        {
                            <Sider Theme="Setting.ToSiderTheme()" Class="@MenuClass" @bind-Collapsed="collapsed" CollapsedWidth="60" Collapsible NoTrigger>
                                <div class="kui-logo"></div>
                                <div class="kui-scroll">
                                    <AntMenu Context="Context" Mode="MenuMode.Inline" Accordion="Setting.Accordion" Theme="Setting.ToMenuTheme()" Items="UserMenus" />
                                </div>
                            </Sider>
                        }
                        <Layout>
                            <Header Class="kui-header">
                                <div class="left">
                                    @if (Setting.LayoutMode != LayoutMode.Float)
                                    {
                                        if (collapsed)
                                        {
                                            <Icon Type="menu-unfold" Theme="outline" Class="trigger" OnClick="OnToggle" />
                                        }
                                        else
                                        {
                                            <Icon Type="menu-fold" Theme="outline" Class="trigger" OnClick="OnToggle" />
                                        }
                                    }
                                    <TopBreadcrumb Current="Context.Current" />
                                </div>
                                <TopNavbar OnMenuClick="OnMenuClick" />
                            </Header>
                            <Content>
                                @if (Setting.MultiTab)
                                {
                                    <ReuseTabs Class="kui-nav-tabs" TabPaneClass="kui-body" Body="Body" />
                                }
                                else
                                {
                                    <div class="kui-body">@Body</div>
                                }
                            </Content>
                            @if (Setting.ShowFooter)
                            {
                                if (UIConfig.Footer != null)
                                {
                                    <Footer Class="kui-footer">@UIConfig.Footer</Footer>
                                }
                                else
                                {
                                    <Footer Class="kui-footer"><KFooter /></Footer>
                                }
                            }
                        </Layout>
                    </Layout>
                }
            }
            @if (IsLogin && !Context.IsMobileApp)
            {
                <Drawer Closable="true" @bind-Visible="showSetting" Placement="right" Title="@(Language["Nav.Setting"])" Width="320">
                    <SettingForm Model="Setting" OnSave="OnSaveSetting" OnReset="OnResetSetting" OnChange="StateHasChanged" />
                </Drawer>
            }
            @if (showSpin)
            {
                <Spin Tip="@spinTip" />
            }
        }
    </LayoutValue>
</div>